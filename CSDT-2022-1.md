# CSDT-2022-1.md

![N](https://escuelaing.s3.amazonaws.com/staging/images/logo-ecijg.width-380.png)

# Contenido
- [Información General del Proyecto](#información-general-del-proyecto)
  * [Gilded Rose](#gilded-rose)
    + [Documentación General](#documentación-general)
    + [Code Smell](#code-smell)
    + [Refactoring](#refactoring)
    + [Clean Code](#clean-code)
    + [Principios de Programación](#principios-de-programación)
    + [Prácticas XP](#prácticas-xp)
    + [Prácticas de Testing](#prácticas-de-testing)
    + [Autor](#autor)

# Información General del Proyecto
## Gilded Rose
Creado originalmente por Terry Hughes (http://twitter.com/TerryHughes), traducida del lenguaje original C#, para este proyecto trabajaremos en la versión del proyecto desarrollado en Python.

### Documentación General
------------
* [Descripción del Proyecto](http://iamnotmyself.com/2011/02/14/refactor-this-the-gilded-rose-kata/)
* [Requerimientos del Proyecto](https://github.com/alexviatela/GildedRose-Refactoring-Kata/blob/develop_code_refactoring/GildedRoseRequirements.txt "Requerimientos del Proyecto")

### Code Smell 
-------------
A continuación se detallan los *code smells* encontrados en el proyecto a trabajar:

* #### Long Methods
La clase principal del proyecto (**GildedRose**)  contiene toda la información y métodos requeridos para el desarrollo del proyecto.

![](https://raw.githubusercontent.com/alexviatela/GildedRose-Refactoring-Kata/develop_code_refactoring/images/ChangePreventersExample.png)

* #### Change Preventers
La actualización de la clase (**Item**) genera cambios en los métodos funcionales del proyecto.
![](https://raw.githubusercontent.com/alexviatela/GildedRose-Refactoring-Kata/develop_code_refactoring/images/LongMethodsExample.png)

* #### Dispensables
Algunos de los métodos incluidos en las clases (**GildedRose & Item**) podrían modificarse para obtener un código más limpio.
![](https://raw.githubusercontent.com/alexviatela/GildedRose-Refactoring-Kata/develop_code_refactoring/images/DispansablesExample.png)

### Refactoring
-------------
A continuación se detalla *refactoring* que se trabajará para el proyecto:

* Extract Variable 
* Extract Method
* Substitute Algorithm 
* Change Reference to Value
* Consolidate Conditional Expression 
* Add Parameter
* Rename Method 
* Rename Variable
* Remove Dead Code 
* Update Notation 

### Clean Code
------------
Para el proyecto se ha encontrado algunas implementaciones de caracteriaticas de Clean Code.

![](https://github.com/alexviatela/GildedRose-Refactoring-Kata/blob/develop_code_refactoring/images/CleanCodeOK.png?raw=true)

![](https://github.com/alexviatela/GildedRose-Refactoring-Kata/blob/develop_code_refactoring/images/CleanCodeFail.png?raw=true)

### Principios de Programación
------------
Algunos de los principios de programación que no se están cumpliendo para el proyecto son:

* #### Yagni - You Aren´t Gonna Need It
El código implementado en el proyecto está agregando cálculos adicionales innecesarios que podrían resumirse y producen un exceso de líneas de código.

* #### KISS - Keep it Simple, Stupid:
El código implementado puede simplificarse y mejorar la eficiencia y comprensión al momento de ejecutarlo.

```python
###### Inicio - Fragmento de Código ######
if item.quality < 50:
                    item.quality = item.quality + 1
                    if item.name == "Backstage passes to a TAFKAL80ETC concert":
                        if item.sell_in < 11:
                            if item.quality < 50:
                                item.quality = item.quality + 1
                        if item.sell_in < 6:
                            if item.quality < 50:
                                item.quality = item.quality + 1
###### End - Fragmento de Código ######
```
### Prácticas XP
------------
Para mejorar la calidad del código del proyecto se podráin implementar varias prácticas de XP, entre ellas están:

* #### Test Driven Development
Se pueden escribir las pruebas unitarias antes de realizar la refactorización del código y de esta manera se mejora la calidad del código.
* #### Planning Game
Se aprueban y revisan inicialmente las características requeridas para el desarrollo del proyecto para definir el correcto alcance de las funcionalidades.
* #### Small Realeses
Generando una primera versión preliminar y realizando el desarrollo incrementalmente para dar solución completa e integral al código implementado.
* #### Refactoring
Eliminar redundancia y código innecesario, mejorar la coherencia del código y realizar el desacoplamiento de los métodos.
* #### Continuous Integration
Se debe mantener el código completamente integrado, se debe revisar que parte de los códigos pueden ser reutilizados en el proyecto, para saber así que es necesario refactorizar.
* #### Simple Design
Realizar la funcionalidad con el menos número de líneas de código posible, simplificando los métodos lo más que se pueda.
* #### Coding Standard
Se mantienen buenas practicas de codificación  utilizando los mismos formatos y estilos para la redacción. Esto facilita la comprensión y refactorización en el proyecto.

### Prácticas de Testing 
------------
Dentro del proyecto se presenta deuda técnica en pruebas y se listan a continuación:

* A pesar de que existe un archivo de pruebas, las pruebas unitarias no son las adecuadas para el proyecto.
* Los estándares de codificación usados para las pruebas no cumplen los requisitos mínimos para la ejecución.
* Faltan escenarios de pruebas.
* El coverage del proyecto es del 5%.

```python
###### Inicio - Fragmento de Código ######
class GildedRoseTest(unittest.TestCase):
    def test_foo(self):
        items = [Item("foo", 0, 0)]
        gilded_rose = GildedRose(items)
        gilded_rose.update_quality()
        self.assertEquals("fixme", items[0].name)

###### End - Fragmento de Código ######
```

#### Reduciendo la deuda de pruebas
Para reducir la deuda técnica en pruebas y mejorar la calidad del código se propone lo siguiente:

* #### Estándares de Nombres para Pruebas Unitarias.
Para mantener el orden en las pruebas unitarias se propone nombrarlas de la siguiente manera:
``` test_(funcionalidad)_(escenario)```
 

* #### Mejoras en Escenarios de Pruebas
Se deben mejorar los escenarios de pruebas unitarias para el proyecto, se proponen los siguientes escenarios:
 * Probar disminución individual de artículos.
```python
###### Inicio - Fragmento de Código ######
 def test_items_decrease_by_one(self):
        self.items.append(Item("Item Test", 10, 20))
        gilded_rose.update_quality(self.items)
        expected = {'sell_in': 9, 'quality': 19}
        item = self.items[0]
        self.assertEqual(item.quality, expected['quality'])
        self.assertEqual(item.sell_in, expected['sell_in'])
###### End - Fragmento de Código ######
```
 * Duplicar la calidad para productos con 10 días o menos restantes.
```python
###### Inicio - Fragmento de Código ######
 def test_quality_by_two_for_products_with_10_days_or_less_left(self):
        self.items.append(Item("Item Test", 10, 34))
        self.items.append(Item("Backstage passes Test", 8, 30))
        gilded_rose.update_quality(self.items)
        expected = [
            {'sell_in': 9, 'quality': 36},
            {'sell_in': 7, 'quality': 32},
        ]

        for index, expectation in enumerate(expected):
            item = self.items[index]
            self.assertEqual(item.quality, expectation['quality'])
            self.assertEqual(item.sell_in, expectation['sell_in'])
###### End - Fragmento de Código ######
```
 * Triplicar la calidad para productos con 5 días o menos restantes.
```python
###### Inicio - Fragmento de Código ######
  def test_quality_by_two_for_products_with_5_days_or_less_left(self):
        self.items.append(Item("Item Test", 4, 11))
        self.items.append(Item("Backstage passes Test", 5, 15))
        gilded_rose.update_quality(self.items)
        expected = [
            {'sell_in': 3, 'quality': 14},
            {'sell_in': 4, 'quality': 18},
        ]

        for index, expectation in enumerate(expected):
            item = self.items[index]
            self.assertEqual(item.quality, expectation['quality'])
            self.assertEqual(item.sell_in, expectation['sell_in'])
###### End - Fragmento de Código ######
```
 * La calidad y la venta disminuyen el doble de rápido después de la venta.
```python
###### Inicio - Fragmento de Código ######
def test_quality_and_sellin_decrease_twice_fast_after_sell_by(self):
        self.items.append(Item("Item Test", 0, 20))
        self.items.append(Item("Item Test", 0, 6))
        gilded_rose.update_quality(self.items)
        expected = [
            {'sell_in': -1, 'quality': 18},
            {'sell_in': -1, 'quality': 4},
        ]

        for index, expectation in enumerate(expected):
            item = self.items[index]
            self.assertEqual(item.quality, expectation['quality'])
            self.assertEqual(item.sell_in, expectation['sell_in'])
###### End - Fragmento de Código ######
```
 * Pasa a calidad cero después de vender productos.
```python
###### Inicio - Fragmento de Código ######
   def test_quality_zero_after_sell_by(self):
        self.items.append(Item("Item Test", 0, 20))
        self.items.append(Item("Backstage passes Item Test", 0, 20))
        gilded_rose.update_quality(self.items)
        expected = [
            {'sell_in': -1, 'quality': 0},
            {'sell_in': -1, 'quality': 0},
        ]

        for index, expectation in enumerate(expected):
            item = self.items[index]
            self.assertEqual(item.quality, expectation['quality'])
            self.assertEqual(item.sell_in, expectation['sell_in'])
###### End - Fragmento de Código ######
```
 * La calidad no aumenta mas de 50.
```python
###### Inicio - Fragmento de Código ######
    def test_quality_does_not_increase_past_50(self):
        self.items.append(Item("Aged Brie", 4, 49))
        gilded_rose.update_quality(self.items)
        expected = {'sell_in': 3, 'quality': 50}
        item = self.items[0]
        self.assertEqual(item.quality, expected['quality'])
        self.assertEqual(item.sell_in, expected['sell_in'])

###### End - Fragmento de Código ######
``` 


* #### Practicas de TDD
Para hacer una ejercicio correcto de pruebas se propone implementar las prácticas de TDD para hacer el refactoring requerido para el proyecto de la mano con el desarrollo de las pruebas necesarias.



------------

##### Autor
Wilmer Alexander Viatela Bravo

